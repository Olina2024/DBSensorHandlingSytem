<!DOCTYPE html>
<html lang="sv" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sensorhistorik</title>
    <style>
        body{font-family:Arial, sans-serif;margin:20px;background:#f5f5f5}
        .card{background:#fff;padding:20px;margin:20px 0;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,.1)}
        h1{color:#4CAF50;text-align:center}
        h3{color:#333}
        form{text-align:center;margin:10px 0}
        label{margin-right:6px}
        button,a{margin-left:6px;padding:6px 10px;border:0;border-radius:3px;background:#4CAF50;color:#fff;text-decoration:none;cursor:pointer}
        button:hover,a:hover{background:#45a049}
        table{width:100%;border-collapse:collapse;margin-top:10px}
        th,td{border:1px solid #ddd;padding:8px;text-align:left}
        th{background:#4CAF50;color:#fff}
        .no-data{color:#666;font-style:italic}
    </style>
</head>
<body>
<h1>Historik</h1>

<div class="card">
    <h3>Sök historiska mätningar</h3>
    <form th:action="@{/Dbsensor/history}" method="get">
        <label for="date">Välj datum:</label>
        <input type="date" id="date" name="date" th:value="${chosenDate != null ? chosenDate : ''}">
        <button type="submit">Sök</button>
        <a th:href="@{/Dbsensor/history}">Visa alla</a>
    </form>

    <p th:if="${chosenDate != null}">
        Visar mätningar för <strong th:text="${chosenDate}"></strong>
    </p>
</div>

<div class="card">
    <h3>Alla Mätningar (Totalt: <span th:text="${totalReadings}">0</span>)</h3>

    <div th:if="${sensors != null and !sensors.isEmpty()}">
        <table>
            <thead>
            <tr>
                <th>Typ</th>
                <th>Värde</th>
                <th>Datum</th>
                <th>Device</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="sensor : ${sensors}">
                <td th:text="${sensor.sensor_reading}">temperature</td>
                <td th:text="${sensor.value}">25.5</td>
                <td th:text="${#temporals.format(sensor.creationDate, 'yyyy-MM-dd HH:mm')}">--</td>
                <td th:text="${sensor.device.device_type}">ESP32S3</td> <!-- här hämtar vi device_type -->
            </tr>
            </tbody>
        </table>
    </div>

    <div th:unless="${sensors != null and !sensors.isEmpty()}">
        <p class="no-data">Ingen data att visa</p>
    </div>
</div>
</body>
</html>
