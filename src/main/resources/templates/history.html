<!DOCTYPE html>
<html lang="sv" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sensorhistorik</title>
    <link rel="stylesheet" href="/webstyle.css">
</head>
<body>
<h1>Historik</h1>

<div class="card">
    <h3>Sök historiska mätningar</h3>
    <form th:action="@{/Dbsensor/history}" method="get">
        <label for="date">Välj datum:</label>
        <input type="date" id="date" name="date" th:value="${chosenDate != null ? chosenDate : ''}">
        <button type="submit">Sök</button>
        <a th:href="@{/Dbsensor/history}">Visa alla</a>
    </form>

    <p th:if="${chosenDate != null}">
        Visar mätningar för <strong th:text="${chosenDate}"></strong>
    </p>
</div>

<div class="card">
    <h3>Alla Mätningar (Totalt: <span th:text="${totalReadings}">0</span>)</h3>

    <div th:if="${sensors != null and !sensors.isEmpty()}">
        <table>
            <thead>
            <tr>
                <th>Typ</th>
                <th>Värde</th>
                <th>Datum</th>
                <th>Device</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="sensor : ${sensors}">
                <td th:text="${sensor.sensor_reading}">temperature</td>
                <td th:text="${sensor.value}">25.5</td>
                <td th:text="${#temporals.format(sensor.creationDate, 'yyyy-MM-dd HH:mm')}">--</td>
                <td th:text="${sensor.device.device_type}">ESP32S3</td> <!-- här hämtar vi device_type -->
            </tr>
            </tbody>
        </table>
    </div>

    <div th:unless="${sensors != null and !sensors.isEmpty()}">
        <p class="no-data">Ingen data att visa</p>
    </div>
</div>
</body>
</html>
